<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="Project site for the SPIN4D collaboration">
  <meta property="og:title" content="SPIN4D Project"/>
  <meta property="og:description" content="SPIN4D Project Information"/>
  <meta property="og:url" content="https://ifauh.github.io/SPIN4D/"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <!--
  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  -->
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <!--
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  -->
  <!-- Keywords for your paper to be indexed by-->
  <!--
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  -->

  <title>SPIN4D</title>
  <link rel="icon" type="image/x-icon" href="static/images/ifaLogo_LARGE.png">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">SPIN4D: Spectropolarimetric Inversion in 4-Dimensions</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block"><a href="FIRST AUTHOR PERSONAL LINK" target="_blank">Xudong Sun</a><sup>1</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Kai Yang</a><sup>1</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Jiayi Liu</a><sup>1</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Yannik Glaser</a><sup>1</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Lucas Tarr</a><sup>2</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Matthias Rempel</a><sup>3</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Sarah Jaeggli</a><sup>2</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Tom Schad</a><sup>2</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">S. C. Dodds</a><sup>1</sup>,</span>
              <span class="author-block"><a href="SECOND AUTHOR PERSONAL LINK" target="_blank">Peter Sadowski</a><sup>1</sup>,</span>  
            </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><sup>1</sup>University of Hawaii Manoa</span>
                    <span class="author-block"><sup>2</sup>National Solar Observatory</span>
                    <span class="author-block"><sup>3</sup>High Altitude Observatory</span>
                    <!--
                    <span class="eql-cntrb"><small><br><sup>*</sup>Indicates Equal Contribution</small></span>
                    -->
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://iopscience.iop.org/article/10.3847/1538-4357/ad865b/" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- Supplementary PDF link -->
                    <span class="link-block">
                      <a href="static/pdfs/supplementary_material.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span>


                  <!-- ✅ GitHub 下拉（与 arXiv 同高度、同外边距、同对齐） -->
                  <span class="link-block">
                    <div class="dd-inline">
                      <!-- 隐藏开关 -->
                      <input id="github-dd" class="dd-toggle" type="checkbox"
                             aria-controls="github-dd-menu" aria-expanded="false">

                      <!-- 按钮本体：与原始按钮相同的 Bulma 类，只多了 has-caret 用于画下拉箭头 -->
                      <label id="github-dd-btn" for="github-dd"
                             class="external-link button is-normal is-rounded is-dark has-caret" role="button">
                        <span class="icon"><i class="fab fa-github" aria-hidden="true"></i></span>
                        <span>GitHub（2）</span>
                      </label>

                      <!-- 下拉菜单 -->
                      <div id="github-dd-menu" class="dropdown-menu" role="menu">
                        <div class="dropdown-content">
                          <a class="dropdown-item" target="_blank" rel="noopener"
                             href="https://github.com/ifauh/spin4d-data">
                            <span class="arxiv-item-title">SPIN4D Data IO</span>
                            <span class="arxiv-item-meta">ifauh/spin4d-data</span>
                          </a>
                          <hr class="dropdown-divider">
                          <a class="dropdown-item" target="_blank" rel="noopener"
                             href="https://github.com/ifauh/HDD">
                            <span class="arxiv-item-title">HDD Source Code</span>
                            <span class="arxiv-item-meta">ifauh/HDD</span>
                          </a>
                        </div>
                      </div>
                    </div>
                  </span>








                      

                <!-- Data link -->
                  <span class="link-block">
                    <a href="http://dtn-itc.ifa.hawaii.edu/spin4d/DR1/" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fa-solid fa-database"></i>
                    </span>
                    <span>Data</span>
                  </a>
                </span>



                <style>
                  .dd-inline { position: relative; display: inline-block; }
                  .dd-inline input.dd-toggle { 
                    position: absolute; left: -9999px; width: 0; height: 0; opacity: 0; 
                  }
                  /* 下拉菜单样式与定位 */
                  .dd-inline .dropdown-menu {
                    display: none;
                    position: absolute; right: 0; top: calc(100% + .25rem);
                    z-index: 30; min-width: 280px;
                  }
                  .dd-inline .dropdown-content .arxiv-item-title { display:block; font-weight:600; }
                  .dd-inline .dropdown-content .arxiv-item-meta  { font-size:.85rem; opacity:.8; }
                  /* 复选框选中时显示菜单 */
                  .dd-inline input.dd-toggle:checked + label + .dropdown-menu { display: block; }

                  /* 让“按钮”本体和你原始按钮完全一致：使用同一套 Bulma 类，不改行高/内边距 */
                  /* 仅用伪元素画三角，不改变高度 */
                  .dd-inline label.button.has-caret::after {
                    content: "▾";
                    margin-left: .5em;
                    font-size: .8em; line-height: 1; display: inline-block; transform: translateY(-1px);
                  }

                  /* 可选：点击菜单外部关闭：用 :has() 支持的浏览器可简易实现（不影响不支持的浏览器）*/
                  @supports(selector(:has(*))) {
                    body:has(.dd-inline input.dd-toggle:checked) .page-overlay-close { display:block; }
                  }
                  .page-overlay-close { display:none; position:fixed; inset:0; }
                </style>

                <!-- 覆盖层（可选，用于点击空白处关闭；不需要 JS） -->
                <div class="page-overlay-close" onclick="document.querySelectorAll('.dd-inline input.dd-toggle').forEach(cb=>cb.checked=false)"></div>

                <!-- ✅ 与其它按钮一致的外壳 -->
                <span class="link-block">
                  <div class="dd-inline">
                    <input id="arxiv-dd" class="dd-toggle" type="checkbox" aria-controls="arxiv-dd-menu" aria-expanded="false">
                    <label id="arxiv-dd-btn" for="arxiv-dd" class="external-link button is-normal is-rounded is-dark has-caret" role="button">
                      <span class="icon"><i class="ai ai-arxiv" aria-hidden="true"></i></span>
                      <span>arXiv（2）</span>
                    </label>
                    <div id="arxiv-dd-menu" class="dropdown-menu" role="menu">
                      <div class="dropdown-content">
                        <a href="https://arxiv.org/abs/2407.20309" target="_blank" rel="noopener" class="dropdown-item">
                          <span class="arxiv-item-title">Paper I</span>
                          <span class="arxiv-item-meta">arXiv:2407.20309 · 2024</span>
                        </a>
                        <hr class="dropdown-divider">
                        <a href="https://arxiv.org/abs/2510.09967" target="_blank" rel="noopener" class="dropdown-item">
                          <span class="arxiv-item-title">Paper II</span>
                          <span class="arxiv-item-meta">arXiv:2510.09967 · 2025</span>
                        </a>
                      </div>
                    </div>
                  </div>
                </span>




















                    
                      
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser video-->
<section class="hero teaser">
  <div class="container is-max-desktop" style="display: flex; flex-direction: row; justify-content: space-around; align-items: center; width: 100%; max-width: 100%;">
    <div class="hero-body" style="flex: 1; display: flex; flex-direction: column; align-items: center;">
      <video poster="" id="tree" autoplay controls muted loop style="width: 100%;">
        <!-- Your video here -->
        <source src="static/videos/ssd200_I.mov" type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Continuum emission at 500 nm from the SSD + 200 G case.
      </h2>
    </div>
    <div class="hero-body" style="flex: 1; display: flex; flex-direction: column; align-items: center;">
      <video poster="" id="tree" autoplay controls muted loop style="width: 100%;">
        <!-- Your video here -->
        <source src="static/videos/ssd200_V.mov" type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        LOS Velocity of optical layer tau=1, of SSD + 200 G case.
      </h2>
    </div>
    <div class="hero-body" style="flex: 1; display: flex; flex-direction: column; align-items: center;">
      <video poster="" id="tree" autoplay controls muted loop style="width: 100%;">
        <!-- Your video here -->
        <source src="static/videos/ssd200_B.mov" type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        LOS Magnetic Field of optical layer tau=1, of SSD + 200 G case.
      </h2>
    </div>    
  </div>
</section>
<!-- End teaser video -->



<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          The National Science Foundation's <i>Daniel K. Inouye Solar Telescope</i> (<i>DKIST</i>) will provide high-resolution, multi-line spectropolarimetric observations that are poised to revolutionize our understanding of the Sun. Given the massive data volume, novel inference techniques are required to unlock its full potential. Here, we provide an overview of our "SPIn4D" project, which aims to develop deep convolutional neural networks (CNNs) for estimating the physical properties of the solar photosphere based on <i>DKIST</i> observations. We describe the magnetohydrodynamic (MHD) modeling and the Stokes profile synthesis pipeline that produce the simulated output and input data, respectively. These data will be used to train a set of CNNs that can rapidly infer the 4D MHD state vectors by exploiting the spatiotemporally coherent patterns in the Stokes-profile time series. Specifically, our radiative MHD model simulates the small-scale dynamo actions that are prevalent in quiet-Sun and plage regions. Four cases with different mean vertical magnetic fields have been conducted; each case covers six solar-hours, totaling 64 TB in data volume. The simulation domain covers 25x25x8 Mm with 16x16x12 km spatial resolution, extending from the upper convection zone up to the temperature minimum. The outputs are generated at a 40 s cadence. We forward model the Stokes profile of two sets of <ion>Fe</ion><sub>1</sub> lines at 630 and 1565 nm, which will be simultaneously observed by <i>DKIST</i> and can better constrain the parameter variations along the line of sight. The MHD model output and the synthetic Stokes profiles are publicly available.</p>
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->


<!-- Image carousel -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item">
          <!-- Your image here -->
          <img src="static/images/fig0_tarr.jpeg" alt="Illustration of the SPIn4D model workflow"/>
          <h2 class="subtitle has-text-centered">
            Illustration of the SPIn4D model workflow. Our model, trained on an extensive library of MHD simulations, processes temporal sequences of Stokes profiles to exploit spatial/temporal coherence. It aims to estimate higher-level 4D parameters directly. On the left, we depict the time series of observed Stokes profiles data cube (I, Q, U, V) as the input for the DL model, predicting the photospheric time-varying 3D physical variables. The process on the right end indicates additional step for deriving other parameters such as vector velocity and Poynting flux. The dashed green box outlines the dataset generation and model training phases.
          </h2>
        </div>
        <div class="item">
          <!-- Your image here -->
          <img src="static/images/fig7.png" alt="Example synthesized spectropolarimetric data"/>
          <h2 class="subtitle has-text-centered">
            Example synthesized spectropolarimetric data computed for a single snapshot of the Case 5 MHD simulation at t=5.6 hrs, 3D data cubes show a subset of the output for both spectral line pairs and both forward modeling codes. The red box in panel (a) marks the source region of the subset in the continuum image. Panel (b) shows the continuum image of the zoom-in subset.
          </h2>
        </div>        
      </div>
    </div>
  </div>
</section>
<!-- End image carousel -->


  

<!-- Paper poster -->
<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Poster</h2>

      <iframe  src="static/pdfs/SHINE2023.pdf" width="100%" height="550">
          </iframe>
        
      </div>
    </div>
  </section>
<!--End paper poster -->


<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Paper II Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Inferring the three-dimensional (3D) solar atmospheric structures from observations is a critical task for advancing our understanding of the magnetic fields and electric currents that drive solar activity. In this work, we introduce a novel, Physics-Informed Machine Learning method to reconstruct the 3D structure of the lower solar atmosphere based on the output of optical depth sampled spectropolarimetric inversions, wherein both the fully disambiguated vector magnetic fields and the geometric height associated with each optical depth are returned simultaneously. Traditional techniques typically resolve the 180-degree azimuthal ambiguity assuming a single layer, either ignoring the intrinsic non-planar physical geometry of constant optical-depth surfaces (e.g., the Wilson depression in sunspots), or correcting the effect as a post-processing step. In contrast, our approach simultaneously maps the optical depths to physical heights, and enforces the divergence-free condition for magnetic fields fully in 3D. Tests on magnetohydrodynamic simulations of quiet Sun, plage, and a sunspot demonstrate that our method reliably recovers the horizontal magnetic field orientation in locations with appreciable magnetic field strength. By coupling the resolutions of the azimuthal ambiguity and the geometric heights problems, we achieve a self-consistent reconstruction of the 3D vector magnetic fields and, by extension, the electric current density and Lorentz force. This physics-constrained, label-free training paradigm is a generalizable, physics-anchored framework that extends across solar magnetic environments while improving the understanding of various solar puzzles
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->


<!-- Image carousel -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item">
          <!-- Your image here -->
          <img src="static/images/flowchart_hdd.png" alt="HDD Workflow"/>
          <h2 class="subtitle has-text-centered">
            Panel (a) shows the flowchart for training the model. The inputs are the 3D magnetic vector fields with azimuthal ambiguity, and an initial guess of the geometric heights associated with each optical-depth layer. The UNet3DB network predicts 3D vector magnetic field, and the UNet3DZ network provides the geometric heights. They are combined to compute a custom loss function with physics law encoded. Panel (b) shows the post-processing step that assembles the outputs from the neural networks (prediction) and the original input magnetic fields into the final output. Panel (c) shows an example of the 3D data, split with overlaps between nearby subfields. These individual subfields are used as the input for training. Panel (d) presents the UNet3D structure
          </h2>
        </div>
        <div class="item">
          <!-- Your image here -->
          <img src="static/images/hdd_geometry.png" alt="HDD Geometric Height Scale Prediction"/>
          <h2 class="subtitle has-text-centered">
            Results for geometric heights for the Sunspot. Panels (a) and (b) present the true and predicted height values for the log10τ = −1 layer. Panels (c)–(f) show vertical cuts across the domain, along the dashed lines in (a). The colors represent the Bz distribution and span the optical depths from log10 τ = 0 to −3.1. The five dashed black curves indicate log10τ values of −0.5, −1, −1.5, −2.0, and −2.5 from bottom to top, respectively. Panels (c) and (e) display ground truth at vertical cuts X = 25.2 Mm and Y = 16.3 Mm, respectively, while (d) and (f) show the corresponding HDD results.
          </h2>
        </div>
        <div class="item">
          <!-- Your image here -->
          <img src="static/images/lorentz_statistic.png" alt="HDD Predicted 3D Vector Electric Current"/>
          <h2 class="subtitle has-text-centered">
            2D histogram comparing the ground truth and the HDD output electric current density. Columns from left to right show the x-, y-, z-components, and absolute current magnitude, while rows from top to bottom represent results for the quiet Sun, plage region, and sunspot, with Pearson correlation coefficients specified for each case. Red and blue dashed lines denote the identity and the best-fit linear relation, respectively.            
          </h2>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End image carousel -->
  
<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{Yang_2024,
doi = {10.3847/1538-4357/ad865b},
url = {https://dx.doi.org/10.3847/1538-4357/ad865b},
year = {2024},
month = {nov},
publisher = {The American Astronomical Society},
volume = {976},
number = {2},
pages = {204},
author = {Kai E. Yang and Lucas A. Tarr and Matthias Rempel and S. Curt Dodds and Sarah A. Jaeggli and Peter Sadowski and Thomas A. Schad and Ian Cunnyngham and Jiayi Liu and Yannik Glaser and Xudong Sun},
title = {Spectropolarimetric Inversion in Four Dimensions with Deep Learning (SPIn4D). I. Overview, Magnetohydrodynamic Modeling, and Stokes Profile Synthesis},
journal = {The Astrophysical Journal},
abstract = {The National Science Foundation’s Daniel K. Inouye Solar Telescope (DKIST) will provide high-resolution, multiline spectropolarimetric observations that are poised to revolutionize our understanding of the Sun. Given the massive data volume, novel inference techniques are required to unlock its full potential. Here, we provide an overview of our “SPIn4D” project, which aims to develop deep convolutional neural networks (CNNs) for estimating the physical properties of the solar photosphere from DKIST spectropolarimetric observations. We describe the magnetohydrodynamic (MHD) modeling and the Stokes profile synthesis pipeline that produce the simulated output and input data, respectively. These data will be used to train a set of CNNs that can rapidly infer the four-dimensional MHD state vectors by exploiting the spatiotemporally coherent patterns in the Stokes profile time series. Specifically, our radiative MHD model simulates the small-scale dynamo actions that are prevalent in quiet-Sun and plage regions. Six cases with different mean magnetic fields have been explored; each case covers six solar-hours, totaling 109 TB in data volume. The simulation domain covers at least 25 × 25 × 8 Mm, with 16 × 16 × 12 km spatial resolution, extending from the upper convection zone up to the temperature minimum region. The outputs are stored at a 40 s cadence. We forward model the Stokes profile of two sets of Fe i lines at 630 and 1565 nm, which will be simultaneously observed by DKIST and can better constrain the parameter variations along the line of sight. The MHD model output and the synthetic Stokes profiles are publicly available, with 13.7 TB in the initial release.}
}

@article{Yang_2025,
       author = {{Yang}, Kai E. and {Sun}, Xudong and {Tarr}, Lucas A. and {Liu}, Jiayi and {Sadowski}, Peter and {Dodds}, S. Curt and {Rempel}, Matthias and {Jaeggli}, Sarah A. and {Schad}, Thomas A. and {Cunnyngham}, Ian and {Glaser}, Yannik and {Wolniewicz}, Linnea},
        title = "{Spectropolarimetric Inversion in Four Dimensions with Deep Learning (SPIn4D): II. A Physics-Informed Machine Learning Method for 3D Solar Photosphere Reconstruction}",
      journal = {arXiv e-prints},
     keywords = {Solar and Stellar Astrophysics},
         year = 2025,
        month = oct,
          eid = {arXiv:2510.09967},
        pages = {arXiv:2510.09967},
archivePrefix = {arXiv},
       eprint = {2510.09967},
 primaryClass = {astro-ph.SR},
       adsurl = {https://ui.adsabs.harvard.edu/abs/2025arXiv251009967Y},
      adsnote = {Provided by the SAO/NASA Astrophysics Data System}
}
</code></pre>
    </div>

    
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
